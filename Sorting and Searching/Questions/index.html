<!doctype html>
<html lang="en">

<head>
        <title>Problems on Sorting and Searching - DBMS</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        
        
        <meta name="author" content="PK">

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="../../assets/css/darcula-highlight.min.css">

        <link rel="stylesheet" href="../../assets/css/bootstrap.min.css">
        <link rel="stylesheet" href="../../assets/css/dracula-ui.min.css">
        <link rel="stylesheet" href="../../assets/css/mkdocs.min.css">

        
            <link  rel="icon" type="image/x-icon" href="../../assets/img/favicon.ico">
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
                <script>hljs.initHighlightingOnLoad();</script>

</head>

<body class="drac-bg-black-secondary drac-text-grey-ternary drac-text drac-scrollbar-purple">

    <main class="d-flex">

        <!-- block sidebar -->
            <nav id="sidebar" class="sidebar drac-bg-black">
    <div class="custom-menu">
        <button type="button" id="sidebarCollapse" class="btn btn-primary">
            <i class="fa fa-bars"></i>
            <span class="sr-only">Menu</span>
        </button>
    </div>

    <div class="p-4">
        

        <div class="drac-text-center">
            
                <span class="drac-text drac-line-height drac-text-white">DBMS</span>
            
        </div>

        <div class="drac-box flex-column">
            <ul class="dot-ul">
                <li><div class="dot-li drac-bg-cyan"></div></li>
                <li><div class="dot-li drac-bg-green"></div></li>
                <li><div class="dot-li drac-bg-orange"></div></li>
                <li><div class="dot-li drac-bg-pink"></div></li>
                <li><div class="dot-li drac-bg-purple"></div></li>
                <li><div class="dot-li drac-bg-red"></div></li>
                <li><div class="dot-li drac-bg-yellow"></div></li>
            </ul>
        </div>

        <hr class="drac-divider" />

        <!-- block menu -->
        <ul class="mb-5 drac-list drac-list-none">
            
            <li class="drac-box">
                <a href="../.."
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Home
                </a>
            </li>
            <li class="drac-box">
                <a href="../.."
                    class="
                    drac-anchor btn-toggle d-inline-flex align-items-center border-0 drac-text-purple--hover collapsed"
                    data-bs-toggle="collapse" data-bs-target="#greedy-collapse" aria-expanded="false">
                    Greedy
                </a>
                <div class="collapse" id="greedy-collapse">
                    <ul class="mb-5 drac-list drac-list-none">
                            
    <li class="drac-box-ternary">
        <a href="../../Greedy/Questions/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Problems on Greedy Algorithms
        </a>
    </li>
                    </ul>
                </div>
            </li>
            <li class="drac-box">
                <a href="../.."
                    class="
                    drac-anchor btn-toggle d-inline-flex align-items-center border-0 drac-text-purple--hover collapsed"
                    data-bs-toggle="collapse" data-bs-target="#heaps-and-trees-collapse" aria-expanded="false">
                    Heaps and Trees
                </a>
                <div class="collapse" id="heaps-and-trees-collapse">
                    <ul class="mb-5 drac-list drac-list-none">
                            
    <li class="drac-box-ternary">
        <a href="../../Heaps%20and%20Trees/Questions/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Leet Code Problems on Heaps and Trees
        </a>
    </li>
                    </ul>
                </div>
            </li>
            <li class="drac-box">
                <a href="../.."
                    class="
                    drac-anchor btn-toggle d-inline-flex align-items-center border-0 drac-text-purple--hover collapsed"
                    data-bs-toggle="collapse" data-bs-target="#graphs-bfs,-dfs,-topological-sorting-collapse" aria-expanded="false">
                    Graphs-BFS, DFS, Topological Sorting
                </a>
                <div class="collapse" id="graphs-bfs,-dfs,-topological-sorting-collapse">
                    <ul class="mb-5 drac-list drac-list-none">
                            
    <li class="drac-box-ternary">
        <a href="../../Graphs-BFS%2C%20DFS%2C%20Topological%20Sorting/Questions/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Leet Code Problems on Graph Algorithms
        </a>
    </li>
                    </ul>
                </div>
            </li>
            <li class="drac-box">
                <a href="../.."
                    class="
                    drac-anchor btn-toggle d-inline-flex align-items-center border-0 drac-text-purple--hover collapsed"
                    data-bs-toggle="collapse" data-bs-target="#arrays,-lists,-stacks,-queues,-hashing-collapse" aria-expanded="false">
                    Arrays, Lists, Stacks, Queues, Hashing
                </a>
                <div class="collapse" id="arrays,-lists,-stacks,-queues,-hashing-collapse">
                    <ul class="mb-5 drac-list drac-list-none">
                            
    <li class="drac-box-ternary">
        <a href="../../Arrays%2C%20Lists%2C%20Stacks%2C%20Queues%2C%20Hashing/Questions/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Leet Code Problems on Arrays, Lists, Stacks, Queues, and Hashing
        </a>
    </li>
                    </ul>
                </div>
            </li>
            <li class="drac-box">
                <a href="../.."
                    class=" active 
                    drac-anchor btn-toggle d-inline-flex align-items-center border-0 drac-text-purple--hover collapsed"
                    data-bs-toggle="collapse" data-bs-target="#sorting-and-searching-collapse" aria-expanded="false">
                    Sorting and Searching
                </a>
                <div class="collapse" id="sorting-and-searching-collapse">
                    <ul class="mb-5 drac-list drac-list-none">
                            
    <li class="drac-box-ternary">
        <a href="./"
            class=" active 
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Problems on Sorting and Searching
        </a>
    </li>
                    </ul>
                </div>
            </li>
            <li class="drac-box">
                <a href="../.."
                    class="
                    drac-anchor btn-toggle d-inline-flex align-items-center border-0 drac-text-purple--hover collapsed"
                    data-bs-toggle="collapse" data-bs-target="#shortest-paths-and-minimum-spanning-trees-collapse" aria-expanded="false">
                    Shortest Paths and Minimum Spanning Trees
                </a>
                <div class="collapse" id="shortest-paths-and-minimum-spanning-trees-collapse">
                    <ul class="mb-5 drac-list drac-list-none">
                            
    <li class="drac-box-ternary">
        <a href="../../Shortest%20Paths%20and%20Minimum%20Spanning%20Trees/Questions/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Leet Code Problems on Shortest Path and Minimum Cost Spanning Trees
        </a>
    </li>
                    </ul>
                </div>
            </li>
            <li class="drac-box">
                <a href="../.."
                    class="
                    drac-anchor btn-toggle d-inline-flex align-items-center border-0 drac-text-purple--hover collapsed"
                    data-bs-toggle="collapse" data-bs-target="#dynamic-programming-collapse" aria-expanded="false">
                    Dynamic Programming
                </a>
                <div class="collapse" id="dynamic-programming-collapse">
                    <ul class="mb-5 drac-list drac-list-none">
                            
    <li class="drac-box-ternary">
        <a href="../../Dynamic%20Programming/Questions/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Leet Code Problems Based on Dynamic Programming
        </a>
    </li>
                    </ul>
                </div>
            </li>
        </ul>
        <!-- endblock -->
    </div>
</nav>
        <!-- endblock -->

        <nav class="divider drac-bg-purple-cyan"></nav>

        <div class="content">
            <!-- block header -->
                <header>
    <nav class="navbar navbar-expand-xl drac-bg-purple">
        <div class="container-fluid">
            
            <button class="navbar-toggler w-100 text-center" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsMenu"
                aria-controls="navbarsMenu" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse flex-column ml-auto" id="navbarsMenu">
                <ul class="navbar-nav text-md-center">

                    <!-- block preview -->
                    <li class="nav-item">
                            
        <div class="container">
            <div class="row row-preview">
                <div class="col">
                    <a href="../../Arrays%2C%20Lists%2C%20Stacks%2C%20Queues%2C%20Hashing/Questions/"
                        class="btn-preview drac-btn drac-btn-outline drac-text-white drac-text-cyan-green--hover">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </div>
                <div class="col">
                    <a href="../../Shortest%20Paths%20and%20Minimum%20Spanning%20Trees/Questions/"
                        class="btn-preview drac-btn drac-btn-outline drac-text-white drac-text-cyan-green--hover" style="padding-left: 3%;">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </div>
            </div>
        </div>
                    </li>
                    <!--  endblock -->

                    <!-- block search -->
                    <li class="nav-item"><div role="search" class="search-box">
	<form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
		<input type="text" name="q" class="drac-input drac-input-search drac-input-white drac-text-white drac-bg-black-secondary"
		placeholder="Search docs" title="Type search term here" />
	</form>
</div>
                    </li>
                    <!--  endblock -->

                    <!-- block source -->
                    <li class="nav-item">
                        
                            
                                <div class="md-source source-detail">
    <div class="md-source-repo-icon">
        <i class="fa fa-github-alt drac-text-white" aria-hidden="true"></i>
    </div>

    <div class="md-source-repo-url">
        <a href="https://github.com/pk1308/DBMS"
            class="md-source drac-anchor drac-text drac-text-white drac-text-cyan-green--hover">
            pk1308/DBMS
        </a>

        <ul class="md-source-repo-text">
            <li>
                <i class="fa fa-tag drac-text-black" aria-hidden="true"></i>
                <img alt="GitHub tag (latest by date)"
                    src="https://img.shields.io/github/v/tag/pk1308/DBMS?color=white&label=%20&style=flat-square">
            </li>

            <li>
                <i class="fa fa-star drac-text-black" aria-hidden="true"></i>
                <img alt="GitHub Repo stars"
                    src="https://img.shields.io/github/stars/pk1308/DBMS?color=white&label=%20&style=flat-square">
            </li>

            <li>
                <i class="fa fa-code-fork drac-text-black" aria-hidden="true"></i>
                <img alt="GitHub forks"
                    src="https://img.shields.io/github/forks/pk1308/DBMS?color=white&label=%20&style=flat-square">
            </li>
        </ul>
    </div>

</div>
                            
                        
                    </li>
                    <!--  endblock -->

                </ul>
            </div>

        </div>
    </nav>
</header>
            <!-- endblock -->

            <!-- block content -->
                <section class="p-md-5 section-content">
    <article>
        <p><div><h1 id="problems-on-sorting-and-searching">Problems on Sorting and Searching</h1>
<h5 id="1-longest-subsequence-with-limited-sum">1. <a href="#1-longest-subsequence-with-limited-sum-1">Longest Subsequence With Limited Sum</a></h5>
<h5 id="2-top-k-frequent-elements">2. <a href="#2-top-k-frequent-elements-1">Top K Frequent Elements</a></h5>
<h5 id="3-sort-colors">3. <a href="#3-sort-colors-1">Sort Colors</a></h5>
<h5 id="4-merge-intervals">4. <a href="#4-merge-intervals-1">Merge Intervals</a></h5>
<h2 id="1-longest-subsequence-with-limited-sum_1">1. <a href="https://leetcode.com/problems/longest-subsequence-with-limited-sum/description/">Longest Subsequence With Limited Sum</a></h2>
<h3 id="11-brute-force">1.1: Brute Force</h3>
<ul>
<li>To find out the maximum number of elements less than or equal to some number, just add the smallest numbers. </li>
<li>Sort the list first.</li>
<li>For every query in <code>queries</code>, find out how many elements can be added by iterating over the array <code>nums</code>.</li>
<li>Complexity: $ O(mn) $</li>
</ul>
<h5 id="code">Code:</h5>
<pre class="highlight"><code>class Solution(object):
    def answerQueries(self, nums, queries):
        """
        :type nums: List[int]
        :type queries: List[int]
        :rtype: List[int]
        """
        answer = [ 0 for i in range(len(queries))]
        nums.sort() # Sort so that adding smallest elements is easier

        for i in range(len(queries)):
            query = queries[i]
            index, count, total = 0, 0, 0

            # For every query, keep adding the smallest element to get the maximum number of 
            # elements whose total is less than or equal to that query
            while total &lt;= query and index &lt; len(nums):
                if total + nums[index] &gt; query:
                    answer[i] = count
                    break
                else:
                    total += nums[index]
                    index += 1
                    count += 1
            answer[i] = count
        return answer</code></pre>
<h3 id="12-prefix-sum">1.2 Prefix Sum</h3>
<ul>
<li>Sort the list first. </li>
<li>Keep a <code>prefix_sum</code> array that has this interpretation: <code>i</code>th index stores the sum of first <code>i</code> smallest elements. Note that this array will be sorted.</li>
<li>For each <code>queries[i]</code>, use binary search on <code>prefix_sum</code> to find out the largest element less than equal to <code>queries[i]</code></li>
<li>Complexity: <span class="arithmatex">\(O(nlogn)\)</span></li>
</ul>
<h5 id="code_1">Code:</h5>
<pre class="highlight"><code>class Solution:
    def answerQueries(self, nums: List[int], queries: List[int]) -&gt; List[int]:
        answer = [0 for i in range(len(queries))] # O(n)
        nums.sort() # O(nlogn)
        prefix_sum = [ ] 

        # O(n)
        for i in range(len(nums)):
            prefix_sum.append(nums[0]) if i == 0 else prefix_sum.append(prefix_sum[i - 1] + nums[i])

        # O (m log n)
        for i in range(len(queries)): # O(m)
            query = queries[i]
            count = self.binarysearch(query, prefix_sum) #O(log n)
            answer[i] = count
        return answer


    def binarysearch( self,v, L):  #v = target element
        low, high = 0, len(L) - 1
        while low &lt;= high: 
            mid = (low + high) // 2
            if L[mid ] &lt; v:
                low = mid  + 1
            elif L[mid ] &gt; v:
                high = mid  - 1
            else:
                return mid + 1 # return the next index than where the element was found
        return low # Returns index where the element should go if not found</code></pre>
<h2 id="2-top-k-frequent-elements_1">2. <a href="https://leetcode.com/problems/top-k-frequent-elements/description/">Top K Frequent Elements</a></h2>
<h3 id="21-using-dictionaries-and-sorting">2.1 Using Dictionaries and Sorting</h3>
<ul>
<li>Initialize a dictionary. For every element in <code>nums</code>, you count occurrences of that element. We can do this in a single pass. Plus this has the added benefit of eliminating duplicates, which we will use later. </li>
<li>For every unique element from the <code>nums</code> array, create a new 2D array where each element is of the format: <code>[element from nums, it's count]</code></li>
<li>Sort this array based on the counts in descending order. </li>
<li>Pick the first <code>k</code> elements.</li>
<li>Complexity: <span class="arithmatex">\(O(mlogm)\)</span>, where <span class="arithmatex">\(m\)</span> is the number of unique elements in <code>nums</code>.</li>
</ul>
<h5 id="code_2">Code:</h5>
<pre class="highlight"><code>class Solution:
    def topKFrequent(self, nums: List[int], k: int) -&gt; List[int]:
        counts = { } # init counts dictionary

        # count the number of occurrences for each element
        for num in nums: # O(n)
            if num in counts:
                counts[num] += 1 
            else:
                counts[num] = 1

        # [ [elem1, it's count], [elem2, it's count], [elem3, it's count] ]
        L = [[x, counts[x]] for x in counts.keys()] # O(m), where m = number of unique elems in nums

        # Sort in descending order based on counts
        L.sort(key=lambda x:x[1], reverse=True) # NOT O(n log n), it's O(m log m)!

        output = [ ]

        # O(k)
        # Pick out the top k elements
        for i in range(k):
            output.append(L[i][0])

        return output</code></pre>
<h2 id="3-sort-colors_1">3. <a href="https://leetcode.com/problems/sort-colors/description/">Sort Colors</a></h2>
<p>This problem is similar to what is discussed in one the practice programming assignments for this week, and we need to solve this problem in <span class="arithmatex">\(O(n)\)</span> complexity. </p>
<h3 id="31-sort-the-nums-in-place">3.1 Sort the <code>nums</code> in place</h3>
<p>We can simply sort the array <code>nums</code> in place are return it. We can use <code>nums.sort()</code> for this. But the comlpexity for this will be: <span class="arithmatex">\(O(n log n)\)</span>. Can we do better?</p>
<h3 id="32-take-count-of-colors">3.2 Take Count of Colors</h3>
<p>We know that there are only three distinct elements in the list. So can we count the occurrences for each distinct color element, and then replace the original array using these counts. 
For example, consider an array <code>nums = [ 2, 0, 2, 1, 1, 0, 1]</code>. We can keep a dictionary for counts as follows: 
</p><pre class="highlight"><code>counts[0] = 2
counts[1] = 3
counts[2] = 2</code></pre>
<p>Then for every color, we can replace <code>nums[i]</code> to <code>nums[i + count]</code> with the color.</p>
<h5 id="code_3">Code:</h5>
<pre class="highlight"><code>class Solution:
    def sortColors(self, nums: List[int]) -&gt; None:
        """
        Do not return anything, modify nums in-place instead.
        """
        counts = { 
            0 : 0, 
            1: 0, 
            2: 0
        }

        # O(n). Take counts for each color
        for i in range(len(nums)):
            counts[nums[i]] += 1

        index = 0

        # O(n). For each color, update the nums[i] to nums[i + count] to the color.
        for i in range(3):
            for count in range(counts[i]):
                nums[index] = i
                index += 1</code></pre>
<h2 id="4-merge-intervals_1">4. <a href="https://leetcode.com/problems/merge-intervals/description/">Merge Intervals</a></h2>
<h3 id="41-sorting-intervals">4.1  Sorting intervals</h3>
<ul>
<li>If we want to merge intervals, it would be easier if overlapping intervals come adjacently in the input list, which means... Sorting!</li>
<li>Sort based on the start of the interval. </li>
<li>
<p>For every interval, check whether start of the interval falls within the end of the merged interval</p>
</li>
<li>
<p>But we will need to consider the below corner cases:</p>
<ul>
<li>One interval subsumes another, then what? This means that the second interval's end is smaller than the first. 
Such as: [1, 10] and [2, 5]</li>
<li>How do you handle last interval?</li>
</ul>
</li>
</ul>
<p>We also need to keep track of the start and the end of the merged intervals.</p>
<h5 id="code_4">Code:</h5>
<pre class="highlight"><code>class Solution:
    def merge(self, intervals: List[List[int]]) -&gt; List[List[int]]:
        if not intervals:
            return []

        # Sort intervals based on the start
        intervals.sort(key=lambda x: x[0])

        merged_intervals = []
        current_start, current_end = intervals[0]

        for interval in intervals[1:]:
            # Overlapping intervals, merge them
            if interval[0] &lt;= current_end:
                current_end = max(current_end, interval[1]) # The max function is required to handle the 1st edge case
            else:
                # Non-overlapping interval found, add previous interval to result
                merged_intervals.append([current_start, current_end])

                # Update current interval
                current_start, current_end = interval

        # Add the last interval
        merged_intervals.append([current_start, current_end])

        return merged_intervals</code></pre></div></p>
    </article>
</section>
            <!-- endblock -->

            <!-- block footer -->
                <footer>
    <div class="d-flex flex-sm-row justify-content-between py-2 border-top drac-text-black drac-bg-cyan-green">
        <a href="https://github.com/dracula/mkdocs" target="_blank" style="padding-left: 1%;"
            class="footer-text drac-anchor drac-text-black drac-text-purple--hover">
            Made with Dracula Theme for MkDocs
        </a>
    </div>
</footer>
            <!-- endblock -->
        </div>

    </main>

        <script>var base_url = '../..';</script>
        <script src="../../assets/js/jquery-3.3.1.slim.min.js"></script>
        <script src="../../assets/js/bootstrap.bundle.min.js"></script>
        <script src="../../assets/js/mkdocs.js"></script>
			<script src="../../javascripts/mathjax.js" defer></script>
			<script src="https://polyfill.io/v3/polyfill.min.js" defer></script>
			<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>
			<script src="../../search/main.js" defer></script>

</body>

</html>